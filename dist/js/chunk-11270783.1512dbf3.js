(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11270783"],{"34c2":function(e,t,r){e.exports=r.p+"img/pdf-icon.50434788.png"},"634a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("global-toolbar",{attrs:{title:"orders"}}),a("v-data-table",{attrs:{headers:e.headers,items:e.orders,"items-per-page":20,"mobile-breakpoint":0,loading:e.tableLoading,"hide-default-footer":""},scopedSlots:e._u([{key:"item",fn:function(t){var r=t.item,s=t.index;return[a("tr",[a("td",[e._v(e._s(r.user_name))]),a("td",[e._v(e._s(r.user_email))]),a("td",[e._v(e._s(r.type))]),a("td",[e._v(e._s(r.order_data_name))]),a("td",[r.seen?a("v-chip",{staticClass:"ma-2",attrs:{color:"green","text-color":"white"}},[e._v("\n            "+e._s(r.seen.date.split(" ")[0])+"\n          ")]):a("v-chip",{staticClass:"ma-2",attrs:{color:"red","text-color":"white"}},[e._v("\n            "+e._s(e.$t("label.no"))+"\n          ")])],1),a("td",[r.closed?a("v-chip",{staticClass:"ma-2",attrs:{color:"green","text-color":"white"}},[e._v("\n            "+e._s(r.closed.date.split(" ")[0])+"\n          ")]):a("v-chip",{staticClass:"ma-2",attrs:{color:"red","text-color":"white"}},[e._v("\n            "+e._s(e.$t("label.no"))+"\n          ")])],1),a("td",[r.closed?a("v-icon",{attrs:{title:e.$t("label.open_order")},on:{click:function(t){return e.handleCloseOrder(r)}}},[e._v("mdi-lock")]):a("v-icon",{attrs:{title:e.$t("label.close_order")},on:{click:function(t){return e.handleCloseOrder(r)}}},[e._v("mdi-lock-open-variant")])],1),a("td",[a("v-icon",{attrs:{title:e.$t("label.show")},on:{click:function(t){return e.handleShow(r)}}},[e._v("mdi-eye")]),a("v-icon",{staticClass:"mx-1",attrs:{title:e.$t("label.delete")},on:{click:function(t){return e.handleDelete(r,s)}}},[e._v("mdi-delete")])],1)])]}}])}),a("div",{staticClass:"text-xs-center pt-2"},[e.orders.length>0&&e.pagination.last_page>1?a("v-pagination",{attrs:{length:e.pagination.last_page,"total-visible":20},on:{input:e.handlePagination},model:{value:e.pagination.current_page,callback:function(t){e.$set(e.pagination,"current_page",t)},expression:"pagination.current_page"}}):e._e()],1),a("v-dialog",{attrs:{"max-width":"700px"},model:{value:e.showOrderDialog,callback:function(t){e.showOrderDialog=t},expression:"showOrderDialog"}},[a("v-card",[a("v-card-title",[e._v(e._s(this.$t("label.order_details")))]),a("v-divider"),e.order.id?a("v-card-text",{staticClass:"py-3 height-90"},[a("h3",{staticClass:"mt-3"},[e._v(e._s(e.$t("label.order_info")))]),a("v-divider"),e._l(e.orderInfo,(function(t,r){return a("v-row",{key:r+6},[t.data?a("v-col",{attrs:{md:"6",cols:"12"}},[a("h4",[e._v(e._s(e.$t("label."+t.key))+" :")])]):e._e(),t.data?a("v-col",{attrs:{md:"6",cols:"12"}},[e._v("\n            "+e._s(t.data)+"\n          ")]):e._e()],1)})),e.order.attachments.length?a("v-row",[a("v-col",{attrs:{md:"6",cols:"12"}},[a("h4",[e._v(e._s(e.$t("label.attachments"))+" :")])]),a("v-col",{attrs:{md:"6",cols:"12"}},[a("v-icon",{attrs:{medium:"",title:"attachment"},on:{click:function(t){return e.showAttachments(e.order)}}},[e._v("mdi-attachment")])],1)],1):e._e(),a("h3",{staticClass:"mt-3"},[e._v(e._s(e.$t("label.status_info")))]),a("v-divider"),e._l(e.orderStatusInfo,(function(t,r){return a("v-row",{key:r},[a("v-col",{attrs:{md:"6",cols:"12"}},[a("h4",[e._v(e._s(e.$t("label."+t.key))+" :")])]),a("v-col",{attrs:{md:"6",cols:"12"}},[e._v("\n            "+e._s(t.data.empty?e.$t("label.no"):t.data.date.split(" ")[0])+"\n          ")])],1)})),a("h3",{staticClass:"mt-3"},[e._v(e._s(e.$t("label.user_info")))]),a("v-divider"),e._l(e.orderUserInfo,(function(t,r){return a("v-row",{key:r+3},[a("v-col",{attrs:{md:"6",cols:"12"}},[a("h4",[e._v(e._s(e.$t("label."+t.key))+" :")])]),"user_phone"===t.key&&!t.data.empty||"user_phone"!==t.key?a("v-col",{attrs:{md:"6",cols:"12"}},[e._v("\n            "+e._s("user_phone"===t.key?t.data.country_code+" / "+t.data.phone:t.data)+"\n          ")]):e._e()],1)}))],2):a("v-card-text",{staticClass:"py-3 text-center"},[a("v-progress-circular",{attrs:{size:100,color:"primary",indeterminate:""}})],1),a("v-divider",{staticClass:"mx-4"}),a("v-card-actions",{staticClass:"py-4 mx-2"},[a("v-spacer"),a("v-btn",{attrs:{color:"primary"},on:{click:e.closeOrderDialog}},[e._v(e._s(this.$t("button.close")))]),a("v-spacer")],1)],1)],1),a("DialogComponent",{scopedSlots:e._u([{key:"heading",fn:function(){return[a("v-card-title",[e._v(e._s(e.$t("heading.attachments")))])]},proxy:!0},{key:"body",fn:function(){return[a("v-row",[e._l(e.photos,(function(e){return a("v-col",{key:e.id,attrs:{cols:"12",md:"3"}},[a("v-img",{attrs:{title:"photo",fluid:"","aspect-ratio":"1",src:e&&e.path}})],1)})),e._l(e.pdfFiles,(function(e){return a("v-col",{key:e.id,attrs:{cols:"12",md:"3"}},[a("a",{attrs:{href:e.path,target:"_blank"}},[a("v-img",{attrs:{title:"pdf",fluid:"","aspect-ratio":"1",src:r("34c2")}})],1)])}))],2)]},proxy:!0}]),model:{value:e.attachmentsDialog,callback:function(t){e.attachmentsDialog=t},expression:"attachmentsDialog"}})],1)},s=[],o=r("297e"),i=r("2cc4"),d=r("a78e"),n=r.n(d),l={name:"order",data(){return{headers:[],orders:[],tableLoading:!0,order:{},orderUserInfo:[],orderInfo:[],orderStatusInfo:[],photos:[],pdfFiles:[],currentOrderId:null,showOrderDialog:!1,attachmentsDialog:!1,locale:n.a.get("language"),pagination:{},queries:{}}},mounted(){this.createTableHeaders()},watch:{$route:{handler(e){this.queries={...e.query},this.getOrders()},immediate:!0},attachmentsDialog:{handler(e){e||(this.photos=[],this.pdfFiles=[])},immediate:!0},showOrderDialog:{handler(e){e||this.getOrders()}}},methods:{createTableHeaders(){const e=["user_name","user_email","type","order_data_name","seen","closed","handle_close","actions"];this.headers=Object(o["a"])(e)},getOrders(){Object(i["b"])({reqName:"orders",query:this.queries}).then(e=>{const{data:t,meta:r}=e.data;this.orders=t,this.pagination=r,console.log("test meta",r)}).catch(e=>{console.log(e)}).finally(()=>{this.tableLoading=!1})},handleShow({id:e}){this.currentOrderId=e,this.showOrderDialog=!0,this.getOrderData()},getOrderData(){Object(i["c"])({reqName:"orders",id:this.currentOrderId,locale:this.locale}).then(e=>{const{order:t}=e.data;this.order={...t},this.handleShowOrderStructure()}).catch(e=>{this.closeOrderDialog(),console.log(e)})},handleShowOrderStructure(){this.resetOrderArrays(),this.orderUserInfo.push({key:"user_name",data:this.order.user_name},{key:"user_email",data:this.order.user_email},{key:"user_phone",data:this.order.user_phone?{...this.order.user_phone}:{empty:!0}}),this.orderUserInfo.forEach(e=>{delete this.order[e.key]}),this.orderStatusInfo.push({key:"seen",data:this.order.seen?{...this.order.seen}:{empty:!0}},{key:"closed",data:this.order.closed?{...this.order.closed}:{empty:!0}}),this.orderStatusInfo.forEach(e=>{delete this.order[e.key]}),delete this.order.order_data,Object.keys(this.order).forEach(e=>{if("extra_services"===e){let t="";this.order[e].forEach(e=>{t+=e.name+" - "}),t=t.slice(0,-2),this.orderInfo.push({key:e,data:t})}else"id"!=e&&"attachments"!=e&&this.orderInfo.push({key:e,data:this.order[e]})})},handleCloseOrder({id:e,closed:t}){this.popUp().then(r=>{if(!r.dismiss){let r=new FormData,a=t?"yes":"no";r.append("closed",a),r.append("_method","PUT"),r.append("locale",this.locale),Object(i["e"])({reqName:"orders",id:e,data:r}).then(()=>{this.getOrders()}).catch(e=>console.log(e))}})},showAttachments({attachments:e}){this.closeOrderDialog(),this.attachmentsDialog=!0,e.map(e=>{"photo"===e.type?this.photos.push(e):"file"===e.type&&this.pdfFiles.push(e)})},handleDelete({id:e},t){this.popUp().then(r=>{r.dismiss||Object(i["a"])({reqName:"orders",id:e}).then(()=>{this.orders.splice(t,1)}).catch(e=>console.log(e))})},handlePagination(e){this.queries.page=e,this.$router.push({query:this.queries})},closeOrderDialog(){this.showOrderDialog=!1,this.resetOrder()},resetOrder(){this.order={},this.resetOrderArrays(),this.locale=n.a.get("language"),this.currentOrderId=null},resetOrderArrays(){this.orderUserInfo=[],this.orderInfo=[],this.orderStatusInfo=[]}}},c=l,h=r("2877"),p=r("6544"),u=r.n(p),_=r("8336"),m=r("b0af"),v=r("99d9"),g=r("cc20"),f=r("62ad"),y=r("8fea"),b=r("169a"),k=r("ce7e"),O=r("132d"),w=r("adda"),D=r("891e"),x=r("490a"),C=r("0fd9"),I=r("2fa4"),$=Object(h["a"])(c,a,s,!1,null,null,null);t["default"]=$.exports;u()($,{VBtn:_["a"],VCard:m["a"],VCardActions:v["a"],VCardText:v["b"],VCardTitle:v["c"],VChip:g["a"],VCol:f["a"],VDataTable:y["a"],VDialog:b["a"],VDivider:k["a"],VIcon:O["a"],VImg:w["a"],VPagination:D["a"],VProgressCircular:x["a"],VRow:C["a"],VSpacer:I["a"]})}}]);
//# sourceMappingURL=chunk-11270783.1512dbf3.js.map