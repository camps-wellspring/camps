(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1afb18a9"],{"4bb2":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("global-toolbar",{attrs:{title:"budget_ranges",actionButton:!0},on:{ButtonClicked:function(t){e.showBudgetsDialog=!0}}}),a("v-data-table",{attrs:{headers:e.headers,items:e.budgets,"hide-default-footer":"",loading:e.tableLoading},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item,i=t.index;return[a("tr",[a("td",[e._v(e._s(s.text)+" "+e._s(e.$t("label.sar")))]),a("td",{staticClass:"toggle-adjust"},[a("toggle-service",{attrs:{"is-edit":!0,"model-name":"budget-ranges","model-id":s.id,field:"project_available",validate:!0},model:{value:s.is_project_available,callback:function(t){e.$set(s,"is_project_available",t)},expression:"item.is_project_available"}})],1),a("td",{staticClass:"toggle-adjust"},[a("toggle-service",{attrs:{"is-edit":!0,"model-name":"budget-ranges","model-id":s.id,field:"service_available",validate:!0},model:{value:s.is_service_available,callback:function(t){e.$set(s,"is_service_available",t)},expression:"item.is_service_available"}})],1),a("td",[a("v-icon",{staticClass:"edit",attrs:{small:"",title:e.$t("label.edit")},on:{click:function(t){return e.handleEdit(s,i)}}},[e._v("mdi-pencil")]),a("v-icon",{staticClass:"delete",attrs:{title:e.$t("label.delete"),small:""},on:{click:function(t){return e.handleDelete(s,i)}}},[e._v("mdi-delete")])],1)])]}}])}),a("v-dialog",{attrs:{"max-width":"700px"},model:{value:e.showBudgetsDialog,callback:function(t){e.showBudgetsDialog=t},expression:"showBudgetsDialog"}},[a("v-card",[a("v-card-title",[e._v(e._s(e.editMode?this.$t("label.edit_budgets"):this.$t("label.create_budgets")))]),a("v-divider"),a("v-card-text",{staticClass:"py-3"},[e.showBudgetsDialog?a("v-form",[a("form-wrapper",{attrs:{validator:e.$v.budget}},[a("v-row",[e.editMode?e._e():a("v-col",{attrs:{cols:"12"}},e._l(e.selectedBudgets,(function(t,s){return a("v-chip",{key:s,staticClass:"ma-2",attrs:{close:""},on:{"click:close":function(t){return e.selectedBudgets.splice(s,1)}}},[e._v("\n                  "+e._s(t)+"\n                ")])})),1),a("v-col",{attrs:{md:e.editMode?12:10,cols:"12"}},[a("form-group",{attrs:{name:"min"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.attrs;return[a("v-text-field",e._b({attrs:{label:e.$t("label.minimum"),type:"number",outlined:""},on:{blur:function(t){return e.$v.budget.min.$touch()}},model:{value:e.budget.min,callback:function(t){e.$set(e.budget,"min",t)},expression:"budget.min"}},"v-text-field",s,!1))]}}],null,!1,4117138225)})],1),e.editMode?e._e():a("v-col",{staticClass:"text-end",attrs:{md:"2",cols:"12"}},[a("v-btn",{attrs:{color:"primary",disabled:e.$v.$invalid,"x-large":""},on:{click:e.addBudget}},[e._v("\n                  "+e._s(e.$t("label.add"))+"\n                ")])],1)],1)],1)],1):e._e()],1),a("v-divider",{staticClass:"mx-4"}),a("v-card-actions",{staticClass:"py-4 mx-2"},[a("v-spacer"),a("v-btn",{attrs:{color:"secondary"},on:{click:e.closeBudgetsDialog}},[e._v(e._s(this.$t("button.cancel")))]),a("v-btn",{attrs:{color:"primary",loading:e.loading.save,disabled:e.saveValidation},on:{click:e.save}},[e._v(e._s(this.$t("button.save")))])],1)],1)],1)],1)},i=[],d=a("297e"),l=a("b5ae"),n=a("2cc4"),r=a("a78e"),o=a.n(r),u={name:"budget_ranges",data(){return{headers:[],budgets:[],tableLoading:!0,budget:{min:null},selectedBudgets:[],currentBudgetId:null,currentBudgetIndex:null,editMode:!1,showBudgetsDialog:!1,loading:{save:!1}}},computed:{saveValidation(){return!this.editMode&&0===this.selectedBudgets.length||this.editMode&&this.$v.$invalid}},mounted(){this.createTableHeaders(),this.getBudgets()},methods:{createTableHeaders(){const e=["range","project_available","service_available","actions"];this.headers=Object(d["a"])(e)},getBudgets(){Object(n["b"])({reqName:"budget-ranges"}).then(e=>{const{data:t}=e.data;this.budgets=t,this.budgets.pop()}).catch(e=>{console.log(e)}).finally(()=>{this.tableLoading=!1})},handleEdit({id:e},t){this.currentBudgetId=e,this.currentBudgetIndex=t,this.editMode=!0,this.showBudgetsDialog=!0,this.getBudgetData()},getBudgetData(){Object(n["c"])({reqName:"budget-ranges",id:this.currentBudgetId,locale:o.a.get("language")}).then(e=>{const{budget_range:t}=e.data;this.budget.min=t.min}).catch(e=>{console.log(e)})},addBudget(){this.selectedBudgets.includes(this.budget.min)||this.selectedBudgets.push(this.budget.min),this.budget.min=null,this.$v.$reset()},save(){this.loading.save=!0,this.editMode?this.UpdateBudget():this.StoreBudget()},StoreBudget(){let e=new FormData;this.selectedBudgets.forEach(t=>{e.append(`ranges[${t}]`,1*t)}),Object(n["d"])({reqName:"budget-ranges",data:e}).then(()=>{this.loading.save=!1,this.getBudgets(),this.closeBudgetsDialog()}).catch(e=>{console.log(e),this.loading.save=!1})},UpdateBudget(){let e=new FormData;e.append("min",this.budget.min),e.append("_method","PUT"),e.append("locale",o.a.get("language")),Object(n["e"])({reqName:"budget-ranges",id:this.currentBudgetId,data:e}).then(e=>{this.budgets.splice(this.currentBudgetIndex,1,e.data.budget_range),this.loading.save=!1,this.getBudgets(),this.closeBudgetsDialog()}).catch(e=>{console.log(e),this.loading.save=!1})},handleDelete({id:e},t){this.popUp().then(a=>{a.dismiss||Object(n["a"])({reqName:"budget-ranges",id:e}).then(()=>{this.budgets.splice(t,1),this.getBudgets()}).catch(e=>console.log(e))})},closeBudgetsDialog(){this.showBudgetsDialog=!1,this.resetBudgets()},resetBudgets(){this.$v.$reset(),this.selectedBudgets=[],this.budget={min:null},this.currentBudgetId=null,this.currentBudgetIndex=null,this.editMode=!1}},validations(){return{budget:{min:{required:l["required"],minValue:Object(l["minValue"])(1),maxValue:Object(l["maxValue"])(1e5)}}}}},c=u,g=a("2877"),h=a("6544"),b=a.n(h),v=a("8336"),m=a("b0af"),p=a("99d9"),_=a("cc20"),B=a("62ad"),f=a("8fea"),$=a("169a"),w=a("ce7e"),V=a("4bd4"),x=a("132d"),D=a("0fd9"),j=a("2fa4"),k=a("8654"),C=Object(g["a"])(c,s,i,!1,null,null,null);t["default"]=C.exports;b()(C,{VBtn:v["a"],VCard:m["a"],VCardActions:p["a"],VCardText:p["b"],VCardTitle:p["c"],VChip:_["a"],VCol:B["a"],VDataTable:f["a"],VDialog:$["a"],VDivider:w["a"],VForm:V["a"],VIcon:x["a"],VRow:D["a"],VSpacer:j["a"],VTextField:k["a"]})},"4bd4":function(e,t,a){"use strict";var s=a("58df"),i=a("7e2b"),d=a("3206");t["a"]=Object(s["a"])(i["a"],Object(d["b"])("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>{return e.$watch("hasError",t=>{this.$set(this.errorBag,e._uid,t)},{immediate:!0})},a={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",s=>{s&&(this.errorBag.hasOwnProperty(e._uid)||(a.valid=t(e)))}):a.valid=t(e),a},validate(){return 0===this.inputs.filter(e=>!e.validate(!0)).length},reset(){this.inputs.forEach(e=>e.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(e=>e.resetValidation()),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find(t=>t._uid===e._uid);if(!t)return;const a=this.watchers.find(e=>e._uid===t._uid);a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter(e=>e._uid!==t._uid),this.inputs=this.inputs.filter(e=>e._uid!==t._uid),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})}}]);
//# sourceMappingURL=chunk-1afb18a9.2647ef62.js.map