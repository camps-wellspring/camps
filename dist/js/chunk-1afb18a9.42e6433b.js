(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1afb18a9"],{"4bb2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main",[a("global-toolbar",{attrs:{title:"budget_ranges",actionButton:!0},on:{ButtonClicked:function(e){t.showBudgetsDialog=!0}}}),a("v-data-table",{attrs:{headers:t.headers,items:t.budgets,"mobile-breakpoint":0,loading:t.tableLoading,"hide-default-footer":""},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item,s=e.index;return[a("tr",[a("td",[t._v(t._s(i.text)+" "+t._s(t.$t("label.sar")))]),a("td",{staticClass:"toggle-adjust"},[0!==i.id?a("toggle-service",{attrs:{"is-edit":!0,"model-name":"budget-ranges","model-id":i.id,field:"project_available",validate:!0},model:{value:i.is_project_available,callback:function(e){t.$set(i,"is_project_available",e)},expression:"item.is_project_available"}}):t._e()],1),a("td",{staticClass:"toggle-adjust"},[0!==i.id?a("toggle-service",{attrs:{"is-edit":!0,"model-name":"budget-ranges","model-id":i.id,field:"service_available",validate:!0},model:{value:i.is_service_available,callback:function(e){t.$set(i,"is_service_available",e)},expression:"item.is_service_available"}}):t._e()],1),a("td",[a("v-icon",{staticClass:"edit",attrs:{small:"",disabled:0===i.id,title:t.$t("label.edit")},on:{click:function(e){return t.handleEdit(i,s)}}},[t._v("mdi-pencil")]),a("v-icon",{staticClass:"delete",attrs:{disabled:0===i.id,title:t.$t("label.delete"),small:""},on:{click:function(e){return t.handleDelete(i,s)}}},[t._v("mdi-delete")])],1)])]}}])}),a("v-dialog",{attrs:{"max-width":"700px"},model:{value:t.showBudgetsDialog,callback:function(e){t.showBudgetsDialog=e},expression:"showBudgetsDialog"}},[a("v-card",[a("v-card-title",[t._v(t._s(t.editMode?this.$t("label.edit_budgets"):this.$t("label.create_budgets")))]),a("v-divider"),a("v-card-text",{staticClass:"py-3"},[t.showBudgetsDialog?a("v-form",{on:{submit:function(e){return e.preventDefault(),t.addBudget(e)}}},[a("form-wrapper",{attrs:{validator:t.$v.budget}},[a("v-row",[t.editMode?t._e():a("v-col",{attrs:{cols:"12"}},t._l(t.selectedBudgets,(function(e,i){return a("v-chip",{key:i,staticClass:"ma-2",attrs:{close:""},on:{"click:close":function(e){return t.selectedBudgets.splice(i,1)}}},[t._v("\n                  "+t._s(e)+"\n                ")])})),1),a("v-col",{attrs:{md:t.editMode?12:10,cols:"12"}},[a("form-group",{attrs:{name:"min"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.attrs;return[a("v-text-field",t._b({attrs:{label:t.$t("label.minimum"),type:"number",outlined:""},on:{blur:function(e){return t.$v.budget.min.$touch()}},model:{value:t.budget.min,callback:function(e){t.$set(t.budget,"min",e)},expression:"budget.min"}},"v-text-field",i,!1))]}}],null,!1,4117138225)})],1),t.editMode?t._e():a("v-col",{staticClass:"text-end",attrs:{md:"2",cols:"12"}},[a("v-btn",{attrs:{color:"primary",disabled:t.$v.$invalid||!t.budget.min,type:"submit","x-large":""}},[t._v("\n                  "+t._s(t.$t("label.add"))+"\n                ")])],1)],1)],1)],1):t._e()],1),a("v-divider",{staticClass:"mx-4"}),a("v-card-actions",{staticClass:"py-4 mx-2"},[a("v-spacer"),a("v-btn",{attrs:{color:"secondary"},on:{click:t.closeBudgetsDialog}},[t._v(t._s(this.$t("button.cancel")))]),a("v-btn",{attrs:{color:"primary",loading:t.loading.save,disabled:t.saveValidation},on:{click:t.save}},[t._v(t._s(this.$t("button.save")))])],1)],1)],1)],1)},s=[],d=a("297e"),l=a("b5ae"),n=a("2cc4"),r=a("a78e"),o=a.n(r),u={name:"budget_ranges",data(){return{headers:[],budgets:[],tableLoading:!0,budget:{min:null},selectedBudgets:[],currentBudgetId:null,currentBudgetIndex:null,editMode:!1,showBudgetsDialog:!1,loading:{save:!1}}},computed:{saveValidation(){return!this.editMode&&0===this.selectedBudgets.length||this.editMode&&this.$v.$invalid}},mounted(){this.createTableHeaders(),this.getBudgets()},methods:{createTableHeaders(){const t=["range","project_available","service_available","actions"];this.headers=Object(d["a"])(t)},getBudgets(){Object(n["b"])({reqName:"budget-ranges"}).then(t=>{const{data:e}=t.data;this.budgets=e}).catch(t=>{console.log(t)}).finally(()=>{this.tableLoading=!1})},handleEdit({id:t},e){this.currentBudgetId=t,this.currentBudgetIndex=e,this.editMode=!0,this.showBudgetsDialog=!0,this.getBudgetData()},getBudgetData(){Object(n["c"])({reqName:"budget-ranges",id:this.currentBudgetId,locale:o.a.get("language")}).then(t=>{const{budget_range:e}=t.data;this.budget.min=e.min}).catch(t=>{console.log(t)})},addBudget(){this.selectedBudgets.includes(this.budget.min)||this.selectedBudgets.push(this.budget.min),this.budget.min=null,this.$v.$reset()},save(){this.loading.save=!0,this.editMode?this.UpdateBudget():this.StoreBudget()},StoreBudget(){let t=new FormData;this.selectedBudgets.forEach(e=>{t.append(`ranges[${e}]`,1*e)}),Object(n["d"])({reqName:"budget-ranges",data:t}).then(()=>{this.loading.save=!1,this.getBudgets(),this.closeBudgetsDialog()}).catch(t=>{console.log(t),this.loading.save=!1})},UpdateBudget(){let t=new FormData;t.append("min",this.budget.min),t.append("_method","PUT"),t.append("locale",o.a.get("language")),Object(n["e"])({reqName:"budget-ranges",id:this.currentBudgetId,data:t}).then(t=>{this.budgets.splice(this.currentBudgetIndex,1,t.data.budget_range),this.loading.save=!1,this.getBudgets(),this.closeBudgetsDialog()}).catch(t=>{console.log(t),this.loading.save=!1})},handleDelete({id:t},e){this.popUp().then(a=>{a.dismiss||Object(n["a"])({reqName:"budget-ranges",id:t}).then(()=>{this.budgets.splice(e,1),this.getBudgets()}).catch(t=>console.log(t))})},closeBudgetsDialog(){this.showBudgetsDialog=!1,this.resetBudgets()},resetBudgets(){this.$v.$reset(),this.selectedBudgets=[],this.budget={min:null},this.currentBudgetId=null,this.currentBudgetIndex=null,this.editMode=!1}},validations(){return{budget:{min:{minValue:Object(l["minValue"])(1)}}}}},c=u,g=a("2877"),h=a("6544"),b=a.n(h),v=a("8336"),m=a("b0af"),p=a("99d9"),_=a("cc20"),B=a("62ad"),f=a("8fea"),$=a("169a"),w=a("ce7e"),V=a("4bd4"),x=a("132d"),D=a("0fd9"),j=a("2fa4"),k=a("8654"),C=Object(g["a"])(c,i,s,!1,null,null,null);e["default"]=C.exports;b()(C,{VBtn:v["a"],VCard:m["a"],VCardActions:p["a"],VCardText:p["b"],VCardTitle:p["c"],VChip:_["a"],VCol:B["a"],VDataTable:f["a"],VDialog:$["a"],VDivider:w["a"],VForm:V["a"],VIcon:x["a"],VRow:D["a"],VSpacer:j["a"],VTextField:k["a"]})},"4bd4":function(t,e,a){"use strict";var i=a("58df"),s=a("7e2b"),d=a("3206");e["a"]=Object(i["a"])(s["a"],Object(d["b"])("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>{return t.$watch("hasError",e=>{this.$set(this.errorBag,t._uid,e)},{immediate:!0})},a={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=t.$watch("shouldValidate",i=>{i&&(this.errorBag.hasOwnProperty(t._uid)||(a.valid=e(t)))}):a.valid=e(t),a},validate(){return 0===this.inputs.filter(t=>!t.validate(!0)).length},reset(){this.inputs.forEach(t=>t.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(t=>t.resetValidation()),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find(e=>e._uid===t._uid);if(!e)return;const a=this.watchers.find(t=>t._uid===e._uid);a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter(t=>t._uid!==e._uid),this.inputs=this.inputs.filter(t=>t._uid!==e._uid),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:t=>this.$emit("submit",t)}},this.$slots.default)}})}}]);
//# sourceMappingURL=chunk-1afb18a9.42e6433b.js.map