(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-236c8186"],{"34c2":function(e,t,a){e.exports=a.p+"img/pdf-icon.50434788.png"},"4bd4":function(e,t,a){"use strict";var i=a("58df"),o=a("7e2b"),s=a("3206");t["a"]=Object(i["a"])(o["a"],Object(s["b"])("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>{return e.$watch("hasError",t=>{this.$set(this.errorBag,e._uid,t)},{immediate:!0})},a={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",i=>{i&&(this.errorBag.hasOwnProperty(e._uid)||(a.valid=t(e)))}):a.valid=t(e),a},validate(){return 0===this.inputs.filter(e=>!e.validate(!0)).length},reset(){this.inputs.forEach(e=>e.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(e=>e.resetValidation()),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find(t=>t._uid===e._uid);if(!t)return;const a=this.watchers.find(e=>e._uid===t._uid);a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter(e=>e._uid!==t._uid),this.inputs=this.inputs.filter(e=>e._uid!==t._uid),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})},eda7:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-toolbar",{attrs:{flat:""}},[i("v-toolbar-title",[e._v(e._s(e.$t("heading.books")))]),i("v-spacer"),i("v-btn",{staticClass:"primary",on:{click:e.handleOpenDialog}},[e._v(e._s(e.$t("button.create")))])],1),i("WrappingTable",{ref:"table_ref",attrs:{headersName:e.headers,pathName:"books"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.item,s=t.index;return[i("td",[i("v-avatar",{attrs:{size:"50"}},[i("v-img",{staticClass:"hover-pointer",attrs:{"aspect-ratio":"1",src:o.main_image&&o.main_image.path},on:{click:function(t){return e.showImagePreview(o.main_image)}}})],1)],1),i("td",{staticClass:"pa-3"},[i("a",{attrs:{href:o.book&&o.book.path,title:"book",target:"_blank"}},[i("v-avatar",{attrs:{size:"50"}},[i("v-img",{staticClass:"hover-pointer",attrs:{"aspect-ratio":"1",src:a("34c2")}})],1)],1)]),i("td",[e._v(e._s(o.name))]),i("td",{attrs:{title:o.short_description}},[e._v("\n        "+e._s(e._f("truncate")(o.short_description))+"\n      ")]),i("td",[i("v-icon",{attrs:{small:"",title:"edit"},on:{click:function(t){return e.handleEdit(o,s)}}},[e._v("\n          mdi-pencil")]),i("v-icon",{attrs:{small:"",title:"delete"},on:{click:function(t){return e.handleDelete(o,s)}}},[e._v("\n          mdi-delete")])],1)]}}])}),i("GenericDialog",{ref:"dialog_ref",on:{dialog_closed:e.onDialogClose},scopedSlots:e._u([{key:"card-title",fn:function(){return[e._v(e._s(e.dialogTitle))]},proxy:!0},{key:"card-text",fn:function(){return[i("formWrapper",{attrs:{validator:e.$v.form}},[i("v-form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[i("v-row",[e.isEdit?i("v-col",{attrs:{cols:"12"}},[i("locale-select",{on:{change:e.fireLocaleChange}})],1):e._e(),i("v-col",{attrs:{cols:"12"}},[i("form-group",{attrs:{name:"name"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.attrs,o=t.listeners;return[i("v-text-field",e._g(e._b({attrs:{outlined:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},"v-text-field",a,!1),o))]}}])})],1),i("v-col",{attrs:{cols:"12"}},[i("form-group",{attrs:{name:"short_description",attribute:"input.short_description"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.attrs,o=t.listeners;return[i("v-textarea",e._g(e._b({attrs:{outlined:"",rows:"10","no-resize":""},model:{value:e.form.short_description,callback:function(t){e.$set(e.form,"short_description",t)},expression:"form.short_description"}},"v-textarea",a,!1),o))]}}])})],1),i("v-col",{attrs:{cols:"12",lg:"6"}},[i("span",[e._v(e._s(e.$t("title.upload_book_cover")))]),i("new-image-upload",{staticClass:"file-upload__image",attrs:{resetToggle:e.resetToggle,imgUrl:e.form.main_image&&e.form.main_image.path,imgId:e.form.main_image&&Number(e.form.main_image.id),maxSize:e.imageSize},on:{fileSelected:e.uploadPhoto,ImageUpdated:e.ImageUpdated}})],1),i("v-col",{attrs:{cols:"12",lg:"6"}},[i("span",[e._v(e._s(e.$t("title.upload_your_book")))]),i("uploadFilePdf",{staticClass:"file-upload__image",attrs:{maxSize:e.pdfSize,fileUrl:e.form.book&&e.form.book.path,fileId:e.form.book&&e.form.book.id,resetToggle:e.resetToggle},on:{FileUpdated:e.FileUpdated,file_selected:e.UploadFile}})],1),i("v-col",[i("v-btn",{staticClass:"primary",attrs:{loading:e.btnLoading,type:"submit",disabled:e.$v.form.$invalid||e.photoAndFilesExist}},[e._v(e._s(e.$t("button.save")))])],1)],1)],1)],1)]},proxy:!0}])}),i("global-image-preview",{attrs:{showDialog:e.imageOverlay,imagePath:e.currentPreviewImage&&e.currentPreviewImage},on:{closePreview:function(t){e.imageOverlay=!1}}})],1)},o=[],s=a("b5ae"),r=a("a78e"),l=a.n(r),n=a("2cc4"),d={name:"Books",components:{GenericDialog:()=>a.e("chunk-f1eca5e6").then(a.bind(null,"376a")),uploadFilePdf:()=>a.e("chunk-2d0bb23a").then(a.bind(null,"39ca"))},data(){return{headers:["image","book","name","description","configs"],imageOverlay:!1,isEdit:!1,form:{name:"",short_description:"",main_image:"",book_file:""},book:{},imageSize:3,pdfSize:20,btnLoading:!1,resetToggle:!1,locale:l.a.get("language")||"en",bookIndex:null}},computed:{dialogTitle(){return this.isEdit?this.$t("title.edit_book"):this.$t("title.Create_book")},photoAndFilesExist(){return""===this.form.main_image||""===this.form.book_file}},methods:{ImageUpdated(){this.$refs.table_ref.handleGetItems()},FileUpdated(){this.$refs.table_ref.handleGetItems()},fireLocaleChange(e){this.locale=e,this.handleShowData(this.form.slug,e)},handleSubmit(){const e=new FormData;this.btnLoading=!0,this.isEdit&&(delete this.form.main_image,delete this.form.book_file,delete this.form.book),Object.keys(this.form).map(t=>{e.append(t,this.form[t])}),this.isEdit?(e.append("locale",this.locale),e.append("_method","put"),this.editBook(e,this.form.slug)):this.createBook(e)},async createBook(e){try{const t=await Object(n["d"])({reqName:"books",data:e});console.log(t);const{book:a}=t.data;this.$refs.table_ref.items.push(a)}catch(t){console.log(t)}finally{this.btnLoading=!1,this.onDialogClose(),this.$refs.dialog_ref.toggleDialog()}},async editBook(e,t){try{const a=await Object(n["e"])({reqName:"books",data:e,id:t}),{book:i}=a.data;console.log(i),this.onDialogClose(),this.$refs.table_ref.handleUpdateItems(i,this.bookIndex),this.$refs.dialog_ref.toggleDialog()}catch(a){console.log(a)}finally{this.btnLoading=!1}},async handleShowData(e,t){const a=await Object(n["c"])({reqName:"books",id:e,locale:t}),{book:i}=a.data;this.form=i},UploadFile(e){this.form.book_file=e.file},handleOpenDialog(){this.$refs.dialog_ref.toggleDialog(),this.resetToggle=!1},uploadPhoto(e){this.form.main_image=e.file},onDialogClose(){this.$v.$reset(),this.isEdit=!1,this.resetToggle=!0,this.form={name:"",short_description:"",main_image:"",book_file:""}},handleEdit({slug:e},t){this.bookIndex=t,this.$refs.dialog_ref.toggleDialog(),this.resetToggle=!1,this.isEdit=!0,this.handleShowData(e)},handleDelete({slug:e},t){this.$refs.table_ref.handleDelete(e,t)},showImagePreview(e){e&&(this.currentPreviewImage=e.path,this.imageOverlay=!0)}},validations:{form:{name:{required:s["required"],minLength:Object(s["minLength"])(3),maxLength:Object(s["maxLength"])(150)},short_description:{required:s["required"],minLength:Object(s["minLength"])(3),maxLength:Object(s["maxLength"])(255)}}}},h=d,c=a("2877"),m=a("6544"),g=a.n(m),u=a("8212"),f=a("8336"),p=a("62ad"),_=a("4bd4"),b=a("132d"),v=a("adda"),k=a("0fd9"),w=a("2fa4"),$=a("8654"),y=a("a844"),x=a("71d9"),D=a("2a7f"),V=Object(c["a"])(h,i,o,!1,null,null,null);t["default"]=V.exports;g()(V,{VAvatar:u["a"],VBtn:f["a"],VCol:p["a"],VForm:_["a"],VIcon:b["a"],VImg:v["a"],VRow:k["a"],VSpacer:w["a"],VTextField:$["a"],VTextarea:y["a"],VToolbar:x["a"],VToolbarTitle:D["b"]})}}]);
//# sourceMappingURL=chunk-236c8186.4a3e7aef.js.map